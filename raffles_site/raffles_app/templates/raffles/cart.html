{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/cart.css' %}">
{% endblock %}

{% block content %}

<!-- =============================
      CARRITO
============================== -->
<section class="cart">
  <h1 class="cart__title">Carrito de Tickets</h1>

  <!-- Mensajes Django -->
  {% if messages %}
    {% for message in messages %}
      <div class="django-message {{ message.tags }}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  <!-- Lista de tickets -->
  <div class="cart__list" id="cartList">
    {% if tickets %}
      {% for ticket in tickets %}
      <div class="cart-item">

        <!-- Información del ticket -->
        <div class="cart-item__info">
          <h3>{{ ticket.raffle.motorcycle.brand }} {{ ticket.raffle.motorcycle.model }}</h3>
          <p class="cart-item__ticket">Ticket #{{ ticket.number }}</p>
          <p class="cart-item__price">${{ ticket.raffle.ticket_price }}</p>
        </div>

        <!-- Acciones -->
        <div class="cart-item__actions">
          <!-- Editar -->
          <a href="{% url 'edit_ticket' ticket.id %}" class="cart-item__edit" aria-label="Editar ticket">
            <i class="fas fa-edit"></i>
          </a>

          <!-- Agregar otro -->
          <a href="{% url 'buy_ticket' ticket.raffle.id %}" class="cart-item__add" aria-label="Agregar ticket">
            <i class="fas fa-plus"></i>
          </a>

          <!-- Eliminar -->
          <form action="{% url 'remove_ticket' ticket.id %}" method="post" class="cart-item__remove-form" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="cart-item__remove" aria-label="Eliminar ticket" >
              <i class="fas fa-trash"></i>
            </button>
          </form>
        </div>

      </div>
      {% endfor %}
    {% else %}
      <p class="cart_empty">Tu carrito está vacío </p>
    {% endif %}
  </div>

  <!-- Resumen -->
  {% if tickets %}
  <div class="cart__summary">
    <p>Total: <span id="cartTotal">${{ total }}</span></p>
    <form action="{% url 'checkout' %}" method="post">
      {% csrf_token %}
      <button type="submit" class="pay-btn">Proceder al Pago</button>
    </form>
  </div>
  {% endif %}

</section>

{% endblock %}
