{% extends 'base.html' %}
{% load static %}

{% block content %}
<section id="winners">
  <div class="winners-title">
    <h2>Ãšltimo Ganador</h2>
    <p class="subtitle">Transparencia en nuestras rifas</p>
  </div>

  <div class="winners-container">
    {% if raffle and raffle.winner_ticket %}
      <!-- Minimapa -->
      <div class="winners-minimap">
        <span>x: 0</span>
        <span>y: 0</span>
      </div>

      <!-- Tarjeta hologrÃ¡fica -->
      <div
        class="winners-card"
        role="region"
        aria-label="Tarjeta hologrÃ¡fica"
        data-active="false"
      >
        <div class="winners-card-inner">
          <!-- Frente -->
          <div class="winners-card-front">
            <h3 class="winners-card-name">{{ raffle.motorcycle.brand }}</h3>

            <!-- Fondo dinÃ¡mico con imagen holograma -->
           <div class="winners-card-bg"
     style="background-image: url(
       {% if raffle.motorcycle.hologram_image %}
         {{ raffle.motorcycle.hologram_image.image.url }}
       {% else %}
         {% static "img/pngwing.png" %}
       {% endif %}
     );">
  <div class="winners-face-highlight"></div>
</div>

            <div class="winners-glare"></div>

            <!-- Logos -->
            <section class="winners-logo-grid" aria-label="Marcas">
              {% for img in raffle.motorcycle.images.all %}
              <div class="winners-logo" style="--icon: url('{{ img.image.url }}')">
                <div class="winners-logo-icon"></div>
              </div>
              {% endfor %}
            </section>

            <!-- Marca de agua -->
            <div class="winners-card-watermark">
              <span class="modelo">{{ raffle.motorcycle.model }}</span>
              <span class="anio">{{ raffle.motorcycle.year }}</span>
              <span class="estado">
                {% if raffle.motorcycle.is_new %}Nueva{% else %}Usada{% endif %}
              </span>
            </div>

            <!-- Flecha -->
            <div class="winners-arrow">â†“</div>

            <!-- BotÃ³n flip -->
            <button class="winners-flip-btn" aria-pressed="false">
              <span>Voltear</span>
            </button>
          </div>

          <!-- Reverso -->
          <div class="winners-card-back">
            <div class="winners-card-bg"
                 style="background: url('{% static "img/back-pattern.png" %}') center/cover no-repeat;">
            </div>
            <div class="winners-glare"></div>

            <!-- Foto del ganador -->
            <div class="winners-photo">
              {% if raffle.winner_ticket.user.profile.photo %}
                <img src="{{ raffle.winner_ticket.user.profile.photo.url }}" alt="Foto del ganador">
              {% else %}
                <img src="{% static 'img/persona.jpg' %}" alt="Foto por defecto">
              {% endif %}
            </div>

            <!-- Info -->
            <div class="winners-info">
              <h3 class="winners-name">
                {{ raffle.winner_ticket.user.get_full_name|default:raffle.winner_ticket.user.username }}
              </h3>
              <p class="winners-number">Ticket #{{ raffle.winner_ticket.number }}</p>
              <p class="winners-ig">
                <i class="fab fa-instagram"></i> @{{ raffle.winner_ticket.user.username }}
              </p>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      <div class="winners-empty text-center">
        <img src="{% static 'img/empty.png' %}" alt="Sin participantes" class="winners-empty-img">
        <p class="subtitle">ðŸš« AÃºn no hay ganadores registrados.</p>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
